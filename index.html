<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Just / Staying PFP Vaults</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:black;color:white;overflow-x:hidden;position:relative;}
h1{text-align:center;margin:20px 0;text-shadow:0 0 10px #00f;}
#vaults,#images{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;margin:20px;}
.vault{width:200px;height:140px;background:#111;border:2px solid #00f;border-radius:15px;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;}
.vault button{margin-top:5px;padding:5px 10px;border:none;border-radius:5px;background:#00f;color:white;cursor:pointer;}
.images-container img{width:100px;height:100px;border-radius:10px;object-fit:cover;border:2px solid #00f;}
#createVaultBtn{display:block;margin:0 auto 20px auto;padding:12px 25px;font-size:18px;border-radius:10px;border:none;background-color:#00f;color:white;cursor:pointer;}
#createVaultBtn:hover{background-color:#0055ff;}
/* Sparkles */
.sparkle{position:absolute;width:3px;height:3px;background:white;border-radius:50%;opacity:0.7;animation:sparkle 3s infinite;}
@keyframes sparkle{0%{transform:translate(0,0);}50%{transform:translate(50px,50px);}100%{transform:translate(0,0);}}
body::after{content:"";position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(to bottom, rgba(0,0,255,0.1), transparent);pointer-events:none;}
</style>
</head>
<body>

<h1>Just / Staying PFP Vaults</h1>
<button id="createVaultBtn">Create Vault</button>
<div id="vaults"></div>
<div id="images" class="images-container"></div>

<script type="module">
// ðŸ”¹ Supabase setup
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

// ðŸ”¹ ÃŽnlocuieÈ™te cu datele tale Supabase:
const supabaseUrl = 'https://okvyoutnsjqzcvceowkt.supabase.co'
const supabaseKey = 'sb_publishable_OAJimlxSmxQXCzg3O1MlCg_A085jpzi'
const supabase = createClient(supabaseUrl, supabaseKey)

// ðŸ”¹ Create Vault
document.getElementById('createVaultBtn').onclick = async () => {
  const name = prompt("Vault name:")
  if(!name) return
  await supabase.from('vaults').insert([{name, images: []}])
  renderVaults()
}

// ðŸ”¹ Render Vaults
async function renderVaults(){
  const { data: vaults } = await supabase.from('vaults').select('*')
  const container = document.getElementById('vaults')
  container.innerHTML = ''
  document.getElementById('images').innerHTML = ''
  vaults.forEach(v=>{
    const div = document.createElement('div')
    div.className='vault'
    div.innerHTML=`
      <div style="font-weight:bold">${v.name}</div>
      <div style="font-size:14px">${v.images.length} images</div>
      <button onclick="uploadImages('${v.id}')">Upload</button>
      <button onclick="viewVault('${v.id}')">View Vault</button>
    `
    container.appendChild(div)
  })
}

// ðŸ”¹ Upload poze
async function uploadImages(vaultId){
  const input = document.createElement('input')
  input.type='file'
  input.multiple=true
  input.onchange = async e => {
    const files = e.target.files
    const { data } = await supabase.from('vaults').select('*').eq('id', vaultId).single()
    let urls = data.images || []

    for(let f of files){
      const { data: uploadData } = await supabase.storage.from('vaults').upload(`${vaultId}/${Date.now()}-${f.name}`, f)
      const publicUrl = supabase.storage.from('vaults').getPublicUrl(uploadData.path).publicUrl
      urls.push(publicUrl)
    }

    await supabase.from('vaults').update({images: urls}).eq('id', vaultId)
    renderVaults()
  }
  input.click()
}

// ðŸ”¹ View Vault
async function viewVault(vaultId){
  const { data } = await supabase.from('vaults').select('*').eq('id', vaultId).single()
  const container=document.getElementById('images')
  container.innerHTML=''
  data.images.forEach(src=>{
    const img=document.createElement('img')
    img.src=src
    container.appendChild(img)
  })
}

// ðŸ”¹ Init
renderVaults()

// ðŸ”¹ Sparkles
for(let i=0;i<50;i++){
  const s=document.createElement('div')
  s.className='sparkle'
  s.style.top=Math.random()*100+'%'
  s.style.left=Math.random()*100+'%'
  s.style.width=(Math.random()*3+2)+'px'
  s.style.height=s.style.width
  s.style.animationDuration=(Math.random()*3+2)+'s'
  document.body.appendChild(s)
}
</script>
</body>
</html>
